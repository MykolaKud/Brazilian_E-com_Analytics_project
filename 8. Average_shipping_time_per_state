#Let's calculate the average shipping time per state

select
  ocd.customer_state,
  round(avg(datediff(ood.order_estimated_delivery_date, ood.order_delivered_carrier_date)),0) as shipping_time
from olist_orders_dataset ood
join olist_customers_dataset ocd on ood.customer_id = ocd.customer_id 
where ood.order_status = 'delivered' and order_estimated_delivery_date <> '' and order_delivered_carrier_date <> ''
group by ocd.customer_state
order by shipping_time desc

